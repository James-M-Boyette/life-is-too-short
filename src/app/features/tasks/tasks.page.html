<section class="wrap">
    <header class="top">
        <h1>Tasks</h1>
        <button type="button" (click)="signOut()">Sign Out</button>
        @if (tasksStore.error()) {
            <p class="error">{{ tasksStore.error() }}</p>
        }
    </header>

    <form class="new" (submit)="onSubmit($event)">
        <input
            type="text"
            placeholder="Add a task…"
            [value]="newTitle()"
            (input)="onInput($event)"
        />
        <button type="submit" [disabled]="!canAdd() || tasksStore.mutating()">Add</button>
    </form>

    @if (tasksStore.loading()) {
        <p>Loading…</p>
    } @else {
        <ul class="list">
            @for (t of tasksStore.tasks(); track t.id) {
                <li class="row">
                    <label class="left">
                        <input
                            type="checkbox"
                            [checked]="t.is_done"
                            (change)="tasksStore.toggleDone(t)"
                            [disabled]="tasksStore.mutating()"
                        />

                        <span [class.done]="t.is_done">{{ t.title }}</span>
                    </label>

                    <button
                        type="button"
                        (click)="tasksStore.remove(t.id)"
                        [disabled]="tasksStore.mutating()"
                    >
                        Delete
                    </button>
                </li>
            }
        </ul>
    }
</section>
